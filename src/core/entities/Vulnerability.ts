import { Vulnerability } from "./types/Vulnerability";

export class Vulnerabilities {
  private vulnerabilityList: Array<Vulnerability>;

  constructor() {
    this.vulnerabilityList = [];
  }

  public addVulnerability(item: Vulnerability): void {
    if (!this.isAlreadyAdded(item.cveId)) {
      this.vulnerabilityList.push(item);
    }
  }
  public get all(): Array<Vulnerability> {
    return this.vulnerabilityList;
  }

  public get length(): number {
    return this.vulnerabilityList.length;
  }
  public isAlreadyAdded(cveId: string): boolean {
    const resp = this.vulnerabilityList.find(
      (item: Vulnerability) => item.cveId == cveId
    );
    return typeof resp != "undefined";
  }

  public toString() {
    let json = JSON.stringify(this.vulnerabilityList);
    json = json.concat("}");
    return '{ "vulnerabilities": '.concat(json);
  }
}
